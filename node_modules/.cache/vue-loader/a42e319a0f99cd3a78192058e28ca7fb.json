{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\cook-rms-master(2)\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\cook-rms-master(2)\\src\\views\\menu\\AddMenu.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\cook-rms-master(2)\\src\\views\\menu\\AddMenu.vue","mtime":1595921372730},{"path":"C:\\Users\\Administrator\\Desktop\\cook-rms-master(2)\\node_modules\\babel-loader\\lib\\index.js","mtime":1595921337356},{"path":"C:\\Users\\Administrator\\Desktop\\cook-rms-master(2)\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1595921340657},{"path":"C:\\Users\\Administrator\\Desktop\\cook-rms-master(2)\\node_modules\\vue-loader\\lib\\index.js","mtime":1595921369308}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJBZGRNZW51IiwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZm9ybU1lbnU6IHsKICAgICAgICAgICAgICAgIC8vIOiPnOiwseeahOWQjeensAogICAgICAgICAgICAgICAgbmFtZTogJycsCiAgICAgICAgICAgICAgICAvLyDoj5zosLHnmoTpmr7luqYKICAgICAgICAgICAgICAgIGRlZzogJycsCiAgICAgICAgICAgICAgICAvLyDoj5zosLHpooTorqHng7npparml7bpl7QKICAgICAgICAgICAgICAgIHRtOiAnJywKICAgICAgICAgICAgICAgIC8vIOWbvueJh3VybOWcsOWdgAogICAgICAgICAgICAgICAgbWVudVVybDogJycsCiAgICAgICAgICAgICAgICAvLyDkvKDovpPnu5nlkI7lj7DnmoTpo5/mnZDmuIXljZUKICAgICAgICAgICAgICAgIGZsOiAnJywKICAgICAgICAgICAgICAgIC8vIOWbvuaWh+iPnOiwseWBmuiPnOatpemqpAogICAgICAgICAgICAgICAgY29va1N0ZXBzOiBbXSwKICAgICAgICAgICAgICAgIGRldmljZUltZ3M6IFtdLAogICAgICAgICAgICAgICAgLy8g5bCP6LS05aOrCiAgICAgICAgICAgICAgICB0aXA6ICcnLAogICAgICAgICAgICAgICAgLy8g5piv5ZCm5Li65a6Y5pa5CiAgICAgICAgICAgICAgICBpc09mZmljaWFsOiBudWxsLAogICAgICAgICAgICAgICAgcHVibGlzaFN0YXR1czogbnVsbCwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgLy8gZmwxIOS4uuS6huWKqOaAgeihqOWNlQogICAgICAgICAgICBmbDE6IFtdLAogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgLy8g5re75Yqg6I+c6LCxCiAgICAgICAgYWRkRmxMaXN0Um93KCkgewogICAgICAgICAgICB0aGlzLmZsMS5wdXNoKHsKICAgICAgICAgICAgICAgICJuYW1lIjogIiIsCiAgICAgICAgICAgICAgICAid2VpZ2h0IjogIiIsCiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBhZGRDb29rU3RlcHNMaXN0Um93KCkgewogICAgICAgICAgICB0aGlzLmZvcm1NZW51LmNvb2tTdGVwcy5wdXNoKHsKICAgICAgICAgICAgICAgICJzdGVwVXJsIjogIiIsCiAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiIiwKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGRlbGV0ZUZsKGluZGV4LCByb3dzKSB7CiAgICAgICAgICAgIHJvd3Muc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB9LAogICAgICAgIGRlbGV0ZUNvb2tTdGVwKGluZGV4LCByb3dzKSB7CiAgICAgICAgICAgIHJvd3Muc3BsaWNlKGluZGV4LCAxKTsKICAgICAgICB9LAogICAgICAgIGFkZE1lbnVEcmFmdEZvcm0oKSB7CiAgICAgICAgICAgIC8vIOiNieeov+eKtuaAgeS4ujAgbWVudUZvcm0KICAgICAgICAgICAgY29uc29sZS5sb2coIuWtmOS4uuiNieeovyIpCiAgICAgICAgICAgIHRoaXMuJHJlZnMubWVudUZvcm0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1NZW51LnB1Ymxpc2hTdGF0dXMgPSAwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybU1lbnUuZmwgPSBKU09OLnN0cmluZ2lmeShKU09OLnBhcnNlKHRoaXMuZmwxKSk7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5mb3JtTWVudS5mbCk7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codmFsaWQpOwogICAgICAgICAgICAgICAgICAgIC8vIOWvueixoei9rOaIkGpzb27lr7nosaEKICAgICAgICAgICAgICAgICAgICBsZXQgZm9ybURhdGEgPSBKU09OLnN0cmluZ2lmeSh0aGlzLmZvcm1NZW51KTsKICAgICAgICAgICAgICAgICAgICBsZXQgY29uZmlnID0gewogICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7IkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9VVRGLTgifQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgbGV0IHVybCA9ICIvYXBpL21lbnUvYWRkTWVudSI7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kYXhpb3MucG9zdCh1cmwsIGZvcm1EYXRhLCBjb25maWcpLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLmt7vliqDmiJDlip8iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOmYsuatouihqOWNleiusOW9leS4iuasoeiusOW9lQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtTWVudT17YnJhbmRfcmlnaHQ6MH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyDmt7vliqDmiJDlip/ot7PovazliLDoj5zosLHpobXpnaIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtwYXRoOiIvbWVudSJ9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvciBzdWJtaXQhIScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICB9LAogICAgICAgIGFkZE1lbnVGb3JtKCl7CiAgICAgICAgICAvLyDkuIrmnrbnirbmgIHkuLoxCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLkuIrmnrYiKTsKICAgICAgICAgICAgdGhpcy4kcmVmcy5tZW51Rm9ybS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICAgICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybU1lbnUucHVibGlzaFN0YXR1cyA9IDE7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtTWVudS5mbCA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZmwxKTsKICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmZvcm1NZW51LmZsKTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh2YWxpZCk7CiAgICAgICAgICAgICAgICAgICAgLy8g5a+56LGh6L2s5oiQanNvbuWvueixoQogICAgICAgICAgICAgICAgICAgIGxldCBmb3JtRGF0YSA9IEpTT04uc3RyaW5naWZ5KHRoaXMuZm9ybU1lbnUpOwogICAgICAgICAgICAgICAgICAgIGxldCBjb25maWcgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOCJ9CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICBsZXQgdXJsID0gIi9hcGkvbWVudS9hZGRNZW51IjsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRheGlvcy5wb3N0KHVybCwgZm9ybURhdGEsIGNvbmZpZykudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIua3u+WKoOaIkOWKnyIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g6Ziy5q2i6KGo5Y2V6K6w5b2V5LiK5qyh6K6w5b2VCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1NZW51PXticmFuZF9yaWdodDowfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOaIkOWKn+i3s+i9rOWIsOiPnOiwsemhtemdogogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goe3BhdGg6Ii9tZW51In0pOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yIHN1Ym1pdCEhJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICAgIH0sCgogICAgfQp9Cg=="},{"version":3,"sources":["AddMenu.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA","file":"AddMenu.vue","sourceRoot":"src/views/menu","sourcesContent":["<template>\r\n  <el-card class=\"box-card\">\r\n    <el-form ref=\"menuForm\" :model=\"formMenu\" >\r\n      <el-form-item label=\"菜谱名称:\" label-width=\"100px\">\r\n        <el-input v-model=\"formMenu.name\" placeholder=\"请输入菜谱名称\" style=\"width:200px\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"菜谱难度:\" label-width=\"100px\">\r\n        <el-select v-model=\"formMenu.deg\" placeholder=\"请选择菜谱难度\">\r\n          <el-option label=\"1\" value=\"1\"></el-option>\r\n          <el-option label=\"2\" value=\"2\"></el-option>\r\n          <el-option label=\"3\" value=\"3\"></el-option>\r\n          <el-option label=\"4\" value=\"4\"></el-option>\r\n          <el-option label=\"5\" value=\"5\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"预计用时:\" label-width=\"100px\" style=\"width:200px\">\r\n        <el-input v-model=\"formMenu.tm\" ></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"菜谱头图:\" label-width=\"100px\" style=\"width:200px\">\r\n        <el-input v-model=\"formMenu.menuUrl\" ></el-input>\r\n      </el-form-item>\r\n<!--      table表格形式可以实现表格的增加一行-->\r\n      <el-form-item label=\"食材清单:\" label-width=\"100px\">\r\n        <el-table\r\n                border\r\n                :data=\"fl1\"\r\n                style=\"width: 50%\">\r\n          <el-table-column fixed=\"left\"  label=\"食材名称\" min-width=\"30\">\r\n            <template slot-scope=\"scope\">\r\n              <el-input v-model=\"scope.row.name\"></el-input>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column  label=\"分量\" min-width=\"20\">\r\n            <template slot-scope=\"scope\">\r\n              <el-input v-model=\"scope.row.weight\"></el-input>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n                  fixed=\"right\"\r\n                  label=\"操作\"\r\n                  width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button\r\n                      @click.native.prevent=\"deleteFl(scope.$index, formMenu.fl)\"\r\n                      type=\"text\"\r\n                      size=\"small\">\r\n                移除\r\n              </el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <el-button type=\"success\" @click=\"addFlListRow()\" round>添加一行</el-button>\r\n      </el-form-item>\r\n      <el-form-item label-width=\"100px\">\r\n        <el-input v-model=\"formMenu.fl\" type=\"hidden\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"图文步骤:\" label-width=\"100px\">\r\n        <el-table\r\n                border\r\n                :data=\"formMenu.cookSteps\"\r\n                style=\"width: 70%\">\r\n          <el-table-column fixed=\"left\"  label=\"图片url\" min-width=\"20\">\r\n            <template slot-scope=\"scope\">\r\n              <el-input v-model=\"scope.row.stepUrl\"></el-input>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column  label=\"图片说明\" min-width=\"40\">\r\n            <template slot-scope=\"scope\">\r\n              <el-input v-model=\"scope.row.description\"></el-input>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column\r\n                  fixed=\"right\"\r\n                  label=\"操作\"\r\n                  min-width=\"10\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button\r\n                      @click.native.prevent=\"deleteCookStep(scope.$index, formMenu.cookSteps)\"\r\n                      type=\"text\"\r\n                      size=\"small\">\r\n                移除\r\n              </el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n        <el-button type=\"success\" @click=\"addCookStepsListRow()\" round>添加一行</el-button>\r\n      </el-form-item>\r\n      <el-form-item label=\"小贴士:\" label-width=\"100px\">\r\n        <el-input v-model=\"formMenu.tip\"\r\n                  placeholder=\"请输入小贴士\"\r\n                  style=\"width:300px\"\r\n                  type=\"textarea\"\r\n                  maxlength=\"200\"\r\n                  show-word-limit\r\n                  clearable\r\n        ></el-input>\r\n      </el-form-item>\r\n      <el-form-item label-width=\"100px\">\r\n        <el-checkbox v-model=\"formMenu.isOfficial\">是否发布为官方菜谱</el-checkbox>\r\n      </el-form-item>\r\n      <el-form-item label-width=\"100px\">\r\n        <el-button type=\"primary\" @click=\"addMenuDraftForm()\">存为草稿</el-button>\r\n        <el-button type=\"primary\" @click=\"addMenuForm()\">上传</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </el-card>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"AddMenu\",\r\n        data() {\r\n            return {\r\n                formMenu: {\r\n                    // 菜谱的名称\r\n                    name: '',\r\n                    // 菜谱的难度\r\n                    deg: '',\r\n                    // 菜谱预计烹饪时间\r\n                    tm: '',\r\n                    // 图片url地址\r\n                    menuUrl: '',\r\n                    // 传输给后台的食材清单\r\n                    fl: '',\r\n                    // 图文菜谱做菜步骤\r\n                    cookSteps: [],\r\n                    deviceImgs: [],\r\n                    // 小贴士\r\n                    tip: '',\r\n                    // 是否为官方\r\n                    isOfficial: null,\r\n                    publishStatus: null,\r\n                },\r\n                // fl1 为了动态表单\r\n                fl1: [],\r\n            }\r\n        },\r\n        methods: {\r\n            // 添加菜谱\r\n            addFlListRow() {\r\n                this.fl1.push({\r\n                    \"name\": \"\",\r\n                    \"weight\": \"\",\r\n                })\r\n            },\r\n            addCookStepsListRow() {\r\n                this.formMenu.cookSteps.push({\r\n                    \"stepUrl\": \"\",\r\n                    \"description\": \"\",\r\n                })\r\n            },\r\n            deleteFl(index, rows) {\r\n                rows.splice(index, 1);\r\n            },\r\n            deleteCookStep(index, rows) {\r\n                rows.splice(index, 1);\r\n            },\r\n            addMenuDraftForm() {\r\n                // 草稿状态为0 menuForm\r\n                console.log(\"存为草稿\")\r\n                this.$refs.menuForm.validate((valid) => {\r\n                    if (valid) {\r\n                        this.formMenu.publishStatus = 0;\r\n                        this.formMenu.fl = JSON.stringify(JSON.parse(this.fl1));\r\n                        // console.log(this.formMenu.fl);\r\n                        // console.log(valid);\r\n                        // 对象转成json对象\r\n                        let formData = JSON.stringify(this.formMenu);\r\n                        let config = {\r\n                            headers: {\"Content-Type\": \"application/json;charset=UTF-8\"}\r\n                        };\r\n                        let url = \"/api/menu/addMenu\";\r\n                        this.$axios.post(url, formData, config).then(res => {\r\n                            if (res.status === 200) {\r\n                                this.$message.success(\"添加成功\");\r\n                                // 防止表单记录上次记录\r\n                                this.formMenu={brand_right:0};\r\n                                // 添加成功跳转到菜谱页面\r\n                                this.$router.push({path:\"/menu\"});\r\n                            } else {\r\n                                console.log('error submit!!');\r\n                                return false;\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n\r\n            },\r\n            addMenuForm(){\r\n              // 上架状态为1\r\n                console.log(\"上架\");\r\n                this.$refs.menuForm.validate((valid) => {\r\n                    if (valid) {\r\n                        this.formMenu.publishStatus = 1;\r\n                        this.formMenu.fl = JSON.stringify(this.fl1);\r\n                        // console.log(this.formMenu.fl);\r\n                        console.log(valid);\r\n                        // 对象转成json对象\r\n                        let formData = JSON.stringify(this.formMenu);\r\n                        let config = {\r\n                            headers: {\"Content-Type\": \"application/json;charset=UTF-8\"}\r\n                        };\r\n                        let url = \"/api/menu/addMenu\";\r\n                        this.$axios.post(url, formData, config).then(res => {\r\n                            if (res.status === 200) {\r\n                                this.$message.success(\"添加成功\");\r\n                                // 防止表单记录上次记录\r\n                                this.formMenu={brand_right:0};\r\n                                // 添加成功跳转到菜谱页面\r\n                                this.$router.push({path:\"/menu\"});\r\n                            } else {\r\n                                console.log('error submit!!');\r\n                                return false;\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n\r\n            },\r\n\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n  .el-form-item {\r\n    margin: 20px 20px ;\r\n  }\r\n</style>\r\n"]}]}